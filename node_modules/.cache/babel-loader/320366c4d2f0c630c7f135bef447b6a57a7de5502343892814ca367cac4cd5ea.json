{"ast":null,"code":"import React,{useState,useEffect}from'react';import{supabase}from'../supabaseClient.ts';import'../styles/UserManagement.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const UserManagement=()=>{const[loading,setLoading]=useState(true);const[users,setUsers]=useState([]);const[error,setError]=useState(null);const[success,setSuccess]=useState(null);// Search and filter state\nconst[searchTerm,setSearchTerm]=useState('');const[roleFilter,setRoleFilter]=useState('');// Pagination\nconst[currentPage,setCurrentPage]=useState(1);const[totalPages,setTotalPages]=useState(1);const usersPerPage=10;// Delete confirmation\nconst[deleteConfirm,setDeleteConfirm]=useState(null);useEffect(()=>{fetchUsers();},[currentPage,roleFilter,searchTerm]);const fetchUsers=async()=>{try{setLoading(true);// Verify admin access\nconst{data:{user}}=await supabase.auth.getUser();if(!user)throw new Error('User not authenticated');const{data:adminCheck}=await supabase.from('profiles').select('role').eq('id',user.id).single();if(!adminCheck||adminCheck.role!=='admin'){throw new Error('You do not have admin access');}// Build query\nlet query=supabase.from('profiles').select('*',{count:'exact'});// Apply filters\nif(roleFilter){query=query.eq('role',roleFilter);}if(searchTerm){query=query.or(`username.ilike.%${searchTerm}%,email.ilike.%${searchTerm}%,full_name.ilike.%${searchTerm}%`);}// Get total count\nconst{count}=await query;setTotalPages(Math.ceil((count||0)/usersPerPage));// Apply pagination\nconst from=(currentPage-1)*usersPerPage;const to=from+usersPerPage-1;const{data,error}=await query.range(from,to).order('created_at',{ascending:false});if(error)throw error;setUsers(data||[]);}catch(err){console.error('Error fetching users:',err);setError(err.message||'Failed to load users');}finally{setLoading(false);}};const handleRoleChange=async(userId,newRole)=>{try{setLoading(true);setError(null);const{error}=await supabase.from('profiles').update({role:newRole}).eq('id',userId);if(error)throw error;setUsers(users.map(user=>user.id===userId?{...user,role:newRole}:user));setSuccess(`User role updated to ${newRole} successfully`);}catch(err){console.error('Error updating user role:',err);setError(err.message||'Failed to update user role');}finally{setLoading(false);}};const handleDeleteUser=async userId=>{try{setLoading(true);setError(null);// Delete user's data\nconst{error:devicesError}=await supabase.from('devices').delete().eq('user_id',userId);if(devicesError)throw devicesError;const{error:petsError}=await supabase.from('pets').delete().eq('user_id',userId);if(petsError)throw petsError;const{error:schedulesError}=await supabase.from('schedules').delete().eq('user_id',userId);if(schedulesError)throw schedulesError;const{error:profileError}=await supabase.from('profiles').delete().eq('id',userId);if(profileError)throw profileError;// Attempt to delete the user auth record\n// Note: This may require additional Supabase admin privileges\nconst{error}=await supabase.auth.admin.deleteUser(userId);if(error)throw error;setUsers(users.filter(user=>user.id!==userId));setDeleteConfirm(null);setSuccess('User deleted successfully');}catch(err){console.error('Error deleting user:',err);setError(err.message||'Failed to delete user');}finally{setLoading(false);}};const handleSearch=e=>{e.preventDefault();setCurrentPage(1);// Reset to first page on new search\nfetchUsers();};const handleRoleFilterChange=e=>{setRoleFilter(e.target.value);setCurrentPage(1);// Reset to first page on filter change\n};const formatDate=dateString=>{return new Date(dateString).toLocaleDateString();};if(loading&&users.length===0){return/*#__PURE__*/_jsxs(\"div\",{className:\"loading-container\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"loading-spinner\"}),/*#__PURE__*/_jsx(\"p\",{children:\"Loading users...\"})]});}return/*#__PURE__*/_jsxs(\"div\",{className:\"user-management-container\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"user-management-header\",children:/*#__PURE__*/_jsx(\"h1\",{children:\"User Management\"})}),error&&/*#__PURE__*/_jsxs(\"div\",{className:\"error-alert\",children:[/*#__PURE__*/_jsx(\"i\",{className:\"icon-warning\"}),/*#__PURE__*/_jsx(\"p\",{children:error}),/*#__PURE__*/_jsx(\"button\",{className:\"error-close\",onClick:()=>setError(null),children:\"\\xD7\"})]}),success&&/*#__PURE__*/_jsxs(\"div\",{className:\"success-alert\",children:[/*#__PURE__*/_jsx(\"i\",{className:\"icon-check-circle\"}),/*#__PURE__*/_jsx(\"p\",{children:success}),/*#__PURE__*/_jsx(\"button\",{className:\"success-close\",onClick:()=>setSuccess(null),children:\"\\xD7\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"user-controls\",children:[/*#__PURE__*/_jsxs(\"form\",{className:\"search-form\",onSubmit:handleSearch,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"search-input\",children:[/*#__PURE__*/_jsx(\"i\",{className:\"icon-search\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Search users...\",value:searchTerm,onChange:e=>setSearchTerm(e.target.value)})]}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"btn btn-primary\",children:\"Search\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"filter-controls\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"role-filter\",children:\"Filter by Role:\"}),/*#__PURE__*/_jsxs(\"select\",{id:\"role-filter\",value:roleFilter,onChange:handleRoleFilterChange,children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"All Roles\"}),/*#__PURE__*/_jsx(\"option\",{value:\"user\",children:\"User\"}),/*#__PURE__*/_jsx(\"option\",{value:\"admin\",children:\"Admin\"})]})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"user-list-container\",children:/*#__PURE__*/_jsxs(\"table\",{className:\"user-table\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:\"User\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Email\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Username\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Joined\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Role\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Actions\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:users.map(user=>{var _user$username,_user$username$;return/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsxs(\"div\",{className:\"user-info\",children:[user.avatar_url?/*#__PURE__*/_jsx(\"img\",{src:user.avatar_url,alt:user.username,className:\"user-avatar\"}):/*#__PURE__*/_jsx(\"div\",{className:\"avatar-placeholder\",children:((_user$username=user.username)===null||_user$username===void 0?void 0:(_user$username$=_user$username[0])===null||_user$username$===void 0?void 0:_user$username$.toUpperCase())||'U'}),/*#__PURE__*/_jsx(\"div\",{className:\"user-name\",children:user.full_name||'No Name'})]})}),/*#__PURE__*/_jsx(\"td\",{children:user.email}),/*#__PURE__*/_jsxs(\"td\",{children:[\"@\",user.username]}),/*#__PURE__*/_jsx(\"td\",{children:formatDate(user.created_at)}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsxs(\"select\",{value:user.role,onChange:e=>handleRoleChange(user.id,e.target.value),className:`role-select ${user.role}`,disabled:loading,children:[/*#__PURE__*/_jsx(\"option\",{value:\"user\",children:\"User\"}),/*#__PURE__*/_jsx(\"option\",{value:\"admin\",children:\"Admin\"})]})}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(\"div\",{className:\"user-actions\",children:/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-icon btn-danger\",onClick:()=>setDeleteConfirm(user.id),title:\"Delete User\",disabled:loading,children:/*#__PURE__*/_jsx(\"i\",{className:\"icon-trash\"})})})})]},user.id);})})]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"pagination\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-sm\",disabled:currentPage===1,onClick:()=>setCurrentPage(prev=>Math.max(1,prev-1)),children:\"Previous\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"page-info\",children:[\"Page \",currentPage,\" of \",totalPages]}),/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-sm\",disabled:currentPage===totalPages,onClick:()=>setCurrentPage(prev=>Math.min(totalPages,prev+1)),children:\"Next\"})]}),deleteConfirm&&/*#__PURE__*/_jsx(\"div\",{className:\"modal-overlay\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"modal-content\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"modal-header\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Delete User\"}),/*#__PURE__*/_jsx(\"button\",{className:\"modal-close\",onClick:()=>setDeleteConfirm(null),children:\"\\xD7\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"modal-body\",children:/*#__PURE__*/_jsx(\"p\",{className:\"confirm-message\",children:\"Are you sure you want to delete this user? This will also delete all associated data including devices, pets, and feeding history. This action cannot be undone.\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"modal-footer\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-outline\",onClick:()=>setDeleteConfirm(null),children:\"Cancel\"}),/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-danger\",onClick:()=>handleDeleteUser(deleteConfirm),disabled:loading,children:\"Delete User\"})]})]})})]});};export default UserManagement;","map":{"version":3,"names":["React","useState","useEffect","supabase","jsx","_jsx","jsxs","_jsxs","UserManagement","loading","setLoading","users","setUsers","error","setError","success","setSuccess","searchTerm","setSearchTerm","roleFilter","setRoleFilter","currentPage","setCurrentPage","totalPages","setTotalPages","usersPerPage","deleteConfirm","setDeleteConfirm","fetchUsers","data","user","auth","getUser","Error","adminCheck","from","select","eq","id","single","role","query","count","or","Math","ceil","to","range","order","ascending","err","console","message","handleRoleChange","userId","newRole","update","map","handleDeleteUser","devicesError","delete","petsError","schedulesError","profileError","admin","deleteUser","filter","handleSearch","e","preventDefault","handleRoleFilterChange","target","value","formatDate","dateString","Date","toLocaleDateString","length","className","children","onClick","onSubmit","type","placeholder","onChange","htmlFor","_user$username","_user$username$","avatar_url","src","alt","username","toUpperCase","full_name","email","created_at","disabled","title","prev","max","min"],"sources":["/workspaces/Smart_Pet_Feeder/src/pages/UserManagement.tsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { supabase } from '../supabaseClient.ts';\nimport { UserProfile } from '../types';\nimport '../styles/UserManagement.css';\n\nconst UserManagement: React.FC = () => {\n  const [loading, setLoading] = useState<boolean>(true);\n  const [users, setUsers] = useState<UserProfile[]>([]);\n  const [error, setError] = useState<string | null>(null);\n  const [success, setSuccess] = useState<string | null>(null);\n  \n  // Search and filter state\n  const [searchTerm, setSearchTerm] = useState<string>('');\n  const [roleFilter, setRoleFilter] = useState<string>('');\n  \n  // Pagination\n  const [currentPage, setCurrentPage] = useState<number>(1);\n  const [totalPages, setTotalPages] = useState<number>(1);\n  const usersPerPage = 10;\n  \n  // Delete confirmation\n  const [deleteConfirm, setDeleteConfirm] = useState<string | null>(null);\n\n  useEffect(() => {\n    fetchUsers();\n  }, [currentPage, roleFilter, searchTerm]);\n\n  const fetchUsers = async () => {\n    try {\n      setLoading(true);\n      \n      // Verify admin access\n      const { data: { user } } = await supabase.auth.getUser();\n      if (!user) throw new Error('User not authenticated');\n      \n      const { data: adminCheck } = await supabase\n        .from('profiles')\n        .select('role')\n        .eq('id', user.id)\n        .single();\n        \n      if (!adminCheck || adminCheck.role !== 'admin') {\n        throw new Error('You do not have admin access');\n      }\n      \n      // Build query\n      let query = supabase.from('profiles').select('*', { count: 'exact' });\n      \n      // Apply filters\n      if (roleFilter) {\n        query = query.eq('role', roleFilter);\n      }\n      \n      if (searchTerm) {\n        query = query.or(`username.ilike.%${searchTerm}%,email.ilike.%${searchTerm}%,full_name.ilike.%${searchTerm}%`);\n      }\n      \n      // Get total count\n      const { count } = await query;\n      setTotalPages(Math.ceil((count || 0) / usersPerPage));\n      \n      // Apply pagination\n      const from = (currentPage - 1) * usersPerPage;\n      const to = from + usersPerPage - 1;\n      \n      const { data, error } = await query\n        .range(from, to)\n        .order('created_at', { ascending: false });\n        \n      if (error) throw error;\n      \n      setUsers(data || []);\n    } catch (err: any) {\n      console.error('Error fetching users:', err);\n      setError(err.message || 'Failed to load users');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleRoleChange = async (userId: string, newRole: 'user' | 'admin') => {\n    try {\n      setLoading(true);\n      setError(null);\n      \n      const { error } = await supabase\n        .from('profiles')\n        .update({ role: newRole })\n        .eq('id', userId);\n        \n      if (error) throw error;\n      \n      setUsers(users.map(user => \n        user.id === userId ? { ...user, role: newRole } : user\n      ));\n      \n      setSuccess(`User role updated to ${newRole} successfully`);\n    } catch (err: any) {\n      console.error('Error updating user role:', err);\n      setError(err.message || 'Failed to update user role');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleDeleteUser = async (userId: string) => {\n    try {\n      setLoading(true);\n      setError(null);\n      \n      // Delete user's data\n      const { error: devicesError } = await supabase\n        .from('devices')\n        .delete()\n        .eq('user_id', userId);\n        \n      if (devicesError) throw devicesError;\n      \n      const { error: petsError } = await supabase\n        .from('pets')\n        .delete()\n        .eq('user_id', userId);\n        \n      if (petsError) throw petsError;\n      \n      const { error: schedulesError } = await supabase\n        .from('schedules')\n        .delete()\n        .eq('user_id', userId);\n        \n      if (schedulesError) throw schedulesError;\n      \n      const { error: profileError } = await supabase\n        .from('profiles')\n        .delete()\n        .eq('id', userId);\n        \n      if (profileError) throw profileError;\n      \n      // Attempt to delete the user auth record\n      // Note: This may require additional Supabase admin privileges\n      const { error } = await supabase.auth.admin.deleteUser(userId);\n      if (error) throw error;\n      \n      setUsers(users.filter(user => user.id !== userId));\n      setDeleteConfirm(null);\n      setSuccess('User deleted successfully');\n    } catch (err: any) {\n      console.error('Error deleting user:', err);\n      setError(err.message || 'Failed to delete user');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleSearch = (e: React.FormEvent) => {\n    e.preventDefault();\n    setCurrentPage(1);  // Reset to first page on new search\n    fetchUsers();\n  };\n\n  const handleRoleFilterChange = (e: React.ChangeEvent<HTMLSelectElement>) => {\n    setRoleFilter(e.target.value);\n    setCurrentPage(1);  // Reset to first page on filter change\n  };\n\n  const formatDate = (dateString: string) => {\n    return new Date(dateString).toLocaleDateString();\n  };\n\n  if (loading && users.length === 0) {\n    return (\n      <div className=\"loading-container\">\n        <div className=\"loading-spinner\"></div>\n        <p>Loading users...</p>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"user-management-container\">\n      <div className=\"user-management-header\">\n        <h1>User Management</h1>\n      </div>\n      \n      {error && (\n        <div className=\"error-alert\">\n          <i className=\"icon-warning\"></i>\n          <p>{error}</p>\n          <button \n            className=\"error-close\" \n            onClick={() => setError(null)}\n          >\n            &times;\n          </button>\n        </div>\n      )}\n      \n      {success && (\n        <div className=\"success-alert\">\n          <i className=\"icon-check-circle\"></i>\n          <p>{success}</p>\n          <button \n            className=\"success-close\" \n            onClick={() => setSuccess(null)}\n          >\n            &times;\n          </button>\n        </div>\n      )}\n      \n      <div className=\"user-controls\">\n        <form className=\"search-form\" onSubmit={handleSearch}>\n          <div className=\"search-input\">\n            <i className=\"icon-search\"></i>\n            <input\n              type=\"text\"\n              placeholder=\"Search users...\"\n              value={searchTerm}\n              onChange={(e) => setSearchTerm(e.target.value)}\n            />\n          </div>\n          <button type=\"submit\" className=\"btn btn-primary\">Search</button>\n        </form>\n        \n        <div className=\"filter-controls\">\n          <label htmlFor=\"role-filter\">Filter by Role:</label>\n          <select\n            id=\"role-filter\"\n            value={roleFilter}\n            onChange={handleRoleFilterChange}\n          >\n            <option value=\"\">All Roles</option>\n            <option value=\"user\">User</option>\n            <option value=\"admin\">Admin</option>\n          </select>\n        </div>\n      </div>\n      \n      <div className=\"user-list-container\">\n        <table className=\"user-table\">\n          <thead>\n            <tr>\n              <th>User</th>\n              <th>Email</th>\n              <th>Username</th>\n              <th>Joined</th>\n              <th>Role</th>\n              <th>Actions</th>\n            </tr>\n          </thead>\n          <tbody>\n            {users.map((user) => (\n              <tr key={user.id}>\n                <td>\n                  <div className=\"user-info\">\n                    {user.avatar_url ? (\n                      <img src={user.avatar_url} alt={user.username} className=\"user-avatar\" />\n                    ) : (\n                      <div className=\"avatar-placeholder\">\n                        {user.username?.[0]?.toUpperCase() || 'U'}\n                      </div>\n                    )}\n                    <div className=\"user-name\">\n                      {user.full_name || 'No Name'}\n                    </div>\n                  </div>\n                </td>\n                <td>{user.email}</td>\n                <td>@{user.username}</td>\n                <td>{formatDate(user.created_at)}</td>\n                <td>\n                  <select\n                    value={user.role}\n                    onChange={(e) => handleRoleChange(user.id, e.target.value as 'user' | 'admin')}\n                    className={`role-select ${user.role}`}\n                    disabled={loading}\n                  >\n                    <option value=\"user\">User</option>\n                    <option value=\"admin\">Admin</option>\n                  </select>\n                </td>\n                <td>\n                  <div className=\"user-actions\">\n                    <button \n                      className=\"btn btn-icon btn-danger\" \n                      onClick={() => setDeleteConfirm(user.id)}\n                      title=\"Delete User\"\n                      disabled={loading}\n                    >\n                      <i className=\"icon-trash\"></i>\n                    </button>\n                  </div>\n                </td>\n              </tr>\n            ))}\n          </tbody>\n        </table>\n      </div>\n      \n      <div className=\"pagination\">\n        <button \n          className=\"btn btn-sm\" \n          disabled={currentPage === 1}\n          onClick={() => setCurrentPage(prev => Math.max(1, prev - 1))}\n        >\n          Previous\n        </button>\n        <span className=\"page-info\">Page {currentPage} of {totalPages}</span>\n        <button \n          className=\"btn btn-sm\" \n          disabled={currentPage === totalPages}\n          onClick={() => setCurrentPage(prev => Math.min(totalPages, prev + 1))}\n        >\n          Next\n        </button>\n      </div>\n      \n      {/* Delete Confirmation Modal */}\n      {deleteConfirm && (\n        <div className=\"modal-overlay\">\n          <div className=\"modal-content\">\n            <div className=\"modal-header\">\n              <h2>Delete User</h2>\n              <button \n                className=\"modal-close\" \n                onClick={() => setDeleteConfirm(null)}\n              >\n                &times;\n              </button>\n            </div>\n            \n            <div className=\"modal-body\">\n              <p className=\"confirm-message\">\n                Are you sure you want to delete this user? This will also delete all associated data\n                including devices, pets, and feeding history. This action cannot be undone.\n              </p>\n            </div>\n            \n            <div className=\"modal-footer\">\n              <button \n                className=\"btn btn-outline\" \n                onClick={() => setDeleteConfirm(null)}\n              >\n                Cancel\n              </button>\n              <button \n                className=\"btn btn-danger\" \n                onClick={() => handleDeleteUser(deleteConfirm)}\n                disabled={loading}\n              >\n                Delete User\n              </button>\n            </div>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default UserManagement;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}
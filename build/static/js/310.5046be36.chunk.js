"use strict";(self.webpackChunksmart_pet_feeder=self.webpackChunksmart_pet_feeder||[]).push([[310],{310:(s,a,e)=>{e.r(a),e.d(a,{default:()=>n});var t=e(43),i=e(584),r=e(58),c=e(461),d=e(579);c.t1.register(c.PP,c.kc,c.FN,c.No,c.Bs,c.E8,c.hE,c.m_,c.s$);const n=()=>{const[s,a]=(0,t.useState)(!0),[e,c]=(0,t.useState)(null),[n,l]=(0,t.useState)(0),[o,h]=(0,t.useState)(0),[x,m]=(0,t.useState)(0),[j,u]=(0,t.useState)(0),[v,N]=(0,t.useState)(0),[p,b]=(0,t.useState)(null),[g,f]=(0,t.useState)(null),[w,y]=(0,t.useState)(null),[S,k]=(0,t.useState)(null);(0,t.useEffect)((()=>{F()}),[]);const F=async()=>{try{a(!0);const{data:{user:s}}=await i.N.auth.getUser();if(!s)throw new Error("User not authenticated");const{data:e}=await i.N.from("profiles").select("role").eq("id",s.id).single();if(!e||"admin"!==e.role)throw new Error("You do not have admin access");const{count:t,error:r}=await i.N.from("profiles").select("*",{count:"exact",head:!0});if(r)throw r;const{count:c,error:d}=await i.N.from("profiles").select("*",{count:"exact",head:!0}).not("email","eq","");if(d)throw d;const{count:n,error:o}=await i.N.from("devices").select("*",{count:"exact",head:!0});if(o)throw o;const{count:x,error:j}=await i.N.from("pets").select("*",{count:"exact",head:!0});if(j)throw j;const{count:v,error:p}=await i.N.from("feeding_history").select("*",{count:"exact",head:!0});if(p)throw p;l(t||0),h(c||0),m(n||0),u(x||0),N(v||0),M(),A(),C(),D()}catch(s){console.error("Error fetching admin data:",s),c(s.message||"Failed to load admin dashboard")}finally{a(!1)}},M=()=>{b({labels:["Jan","Feb","Mar","Apr","May","Jun","Jul"],datasets:[{label:"New Users",data:[5,8,12,15,20,25,30],borderColor:"rgba(54, 162, 235, 1)",backgroundColor:"rgba(54, 162, 235, 0.2)",tension:.3}]})},A=()=>{f({labels:["Online","Offline","Low Food"],datasets:[{data:[.7*x,.2*x,.1*x],backgroundColor:["rgba(75, 192, 192, 0.7)","rgba(255, 99, 132, 0.7)","rgba(255, 205, 86, 0.7)"],borderColor:["rgba(75, 192, 192, 1)","rgba(255, 99, 132, 1)","rgba(255, 205, 86, 1)"],borderWidth:1}]})},C=()=>{y({labels:["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],datasets:[{label:"Scheduled Feedings",data:[15,18,14,20,16,12,10],backgroundColor:"rgba(54, 162, 235, 0.7)"},{label:"Manual Feedings",data:[8,5,9,6,10,12,7],backgroundColor:"rgba(255, 99, 132, 0.7)"}]})},D=()=>{const s={labels:["1 Device","2 Devices","3+ Devices"],datasets:[{label:"Users",data:[Math.floor(.6*n),Math.floor(.3*n),Math.floor(.1*n)],backgroundColor:["rgba(255, 99, 132, 0.7)","rgba(54, 162, 235, 0.7)","rgba(75, 192, 192, 0.7)"],borderColor:["rgba(255, 99, 132, 1)","rgba(54, 162, 235, 1)","rgba(75, 192, 192, 1)"],borderWidth:1}]};k(s)};return s?(0,d.jsxs)("div",{className:"loading-container",children:[(0,d.jsx)("div",{className:"loading-spinner"}),(0,d.jsx)("p",{children:"Loading admin dashboard..."})]}):e?(0,d.jsxs)("div",{className:"error-container",children:[(0,d.jsx)("i",{className:"icon-error"}),(0,d.jsx)("h2",{children:"Error"}),(0,d.jsx)("p",{children:e})]}):(0,d.jsxs)("div",{className:"admin-dashboard-container",children:[(0,d.jsxs)("div",{className:"admin-header",children:[(0,d.jsx)("h1",{children:"Admin Dashboard"}),(0,d.jsx)("div",{className:"admin-actions",children:(0,d.jsxs)("button",{className:"btn btn-outline",children:[(0,d.jsx)("i",{className:"icon-download"})," Export Data"]})})]}),(0,d.jsxs)("div",{className:"stats-grid",children:[(0,d.jsxs)("div",{className:"stat-card",children:[(0,d.jsx)("div",{className:"stat-icon user-icon",children:(0,d.jsx)("i",{className:"icon-users"})}),(0,d.jsxs)("div",{className:"stat-content",children:[(0,d.jsx)("h3",{children:"Total Users"}),(0,d.jsx)("div",{className:"stat-value",children:n}),(0,d.jsxs)("div",{className:"stat-secondary",children:[o," verified (",Math.round(o/n*100),"%)"]})]})]}),(0,d.jsxs)("div",{className:"stat-card",children:[(0,d.jsx)("div",{className:"stat-icon device-icon",children:(0,d.jsx)("i",{className:"icon-device"})}),(0,d.jsxs)("div",{className:"stat-content",children:[(0,d.jsx)("h3",{children:"Total Devices"}),(0,d.jsx)("div",{className:"stat-value",children:x}),(0,d.jsxs)("div",{className:"stat-secondary",children:[(x/n).toFixed(1)," avg per user"]})]})]}),(0,d.jsxs)("div",{className:"stat-card",children:[(0,d.jsx)("div",{className:"stat-icon pet-icon",children:(0,d.jsx)("i",{className:"icon-paw"})}),(0,d.jsxs)("div",{className:"stat-content",children:[(0,d.jsx)("h3",{children:"Total Pets"}),(0,d.jsx)("div",{className:"stat-value",children:j}),(0,d.jsxs)("div",{className:"stat-secondary",children:[(j/n).toFixed(1)," avg per user"]})]})]}),(0,d.jsxs)("div",{className:"stat-card",children:[(0,d.jsx)("div",{className:"stat-icon food-icon",children:(0,d.jsx)("i",{className:"icon-food"})}),(0,d.jsxs)("div",{className:"stat-content",children:[(0,d.jsx)("h3",{children:"Total Feedings"}),(0,d.jsx)("div",{className:"stat-value",children:v}),(0,d.jsxs)("div",{className:"stat-secondary",children:[Math.round(v/7)," avg per day (week)"]})]})]})]}),(0,d.jsxs)("div",{className:"charts-grid",children:[(0,d.jsxs)("div",{className:"chart-card wide",children:[(0,d.jsx)("h3",{children:"User Growth"}),(0,d.jsx)("div",{className:"chart-container",children:p&&(0,d.jsx)(r.N1,{data:p,options:{responsive:!0,maintainAspectRatio:!1}})})]}),(0,d.jsxs)("div",{className:"chart-card",children:[(0,d.jsx)("h3",{children:"Device Status"}),(0,d.jsx)("div",{className:"chart-container",children:g&&(0,d.jsx)(r.nu,{data:g,options:{responsive:!0,maintainAspectRatio:!1}})})]}),(0,d.jsxs)("div",{className:"chart-card",children:[(0,d.jsx)("h3",{children:"Device Distribution"}),(0,d.jsx)("div",{className:"chart-container",children:S&&(0,d.jsx)(r.nu,{data:S,options:{responsive:!0,maintainAspectRatio:!1}})})]}),(0,d.jsxs)("div",{className:"chart-card wide",children:[(0,d.jsx)("h3",{children:"Feeding History (Last Week)"}),(0,d.jsx)("div",{className:"chart-container",children:w&&(0,d.jsx)(r.yP,{data:w,options:{responsive:!0,maintainAspectRatio:!1}})})]})]}),(0,d.jsxs)("div",{className:"system-status",children:[(0,d.jsx)("h2",{children:"System Status"}),(0,d.jsxs)("div",{className:"status-grid",children:[(0,d.jsxs)("div",{className:"status-card",children:[(0,d.jsxs)("div",{className:"status-header",children:[(0,d.jsx)("h3",{children:"Database"}),(0,d.jsx)("span",{className:"status-indicator healthy",children:"Healthy"})]}),(0,d.jsxs)("div",{className:"status-details",children:[(0,d.jsxs)("div",{className:"status-metric",children:[(0,d.jsx)("span",{children:"Query Performance:"}),(0,d.jsx)("span",{children:"27ms avg"})]}),(0,d.jsxs)("div",{className:"status-metric",children:[(0,d.jsx)("span",{children:"Storage Used:"}),(0,d.jsx)("span",{children:"12%"})]})]})]}),(0,d.jsxs)("div",{className:"status-card",children:[(0,d.jsxs)("div",{className:"status-header",children:[(0,d.jsx)("h3",{children:"Authentication"}),(0,d.jsx)("span",{className:"status-indicator healthy",children:"Healthy"})]}),(0,d.jsxs)("div",{className:"status-details",children:[(0,d.jsxs)("div",{className:"status-metric",children:[(0,d.jsx)("span",{children:"Active Sessions:"}),(0,d.jsx)("span",{children:Math.round(.4*n)})]}),(0,d.jsxs)("div",{className:"status-metric",children:[(0,d.jsx)("span",{children:"Auth Success Rate:"}),(0,d.jsx)("span",{children:"99.7%"})]})]})]}),(0,d.jsxs)("div",{className:"status-card",children:[(0,d.jsxs)("div",{className:"status-header",children:[(0,d.jsx)("h3",{children:"API"}),(0,d.jsx)("span",{className:"status-indicator healthy",children:"Healthy"})]}),(0,d.jsxs)("div",{className:"status-details",children:[(0,d.jsxs)("div",{className:"status-metric",children:[(0,d.jsx)("span",{children:"Response Time:"}),(0,d.jsx)("span",{children:"65ms avg"})]}),(0,d.jsxs)("div",{className:"status-metric",children:[(0,d.jsx)("span",{children:"Requests (24h):"}),(0,d.jsx)("span",{children:Math.round(50*n)})]})]})]}),(0,d.jsxs)("div",{className:"status-card",children:[(0,d.jsxs)("div",{className:"status-header",children:[(0,d.jsx)("h3",{children:"Storage"}),(0,d.jsx)("span",{className:"status-indicator healthy",children:"Healthy"})]}),(0,d.jsxs)("div",{className:"status-details",children:[(0,d.jsxs)("div",{className:"status-metric",children:[(0,d.jsx)("span",{children:"Total Files:"}),(0,d.jsx)("span",{children:2*n})]}),(0,d.jsxs)("div",{className:"status-metric",children:[(0,d.jsx)("span",{children:"Storage Used:"}),(0,d.jsx)("span",{children:"126 MB"})]})]})]})]})]})]})}}}]);
//# sourceMappingURL=310.5046be36.chunk.js.map
"use strict";(self.webpackChunksmart_pet_feeder=self.webpackChunksmart_pet_feeder||[]).push([[214],{214:(e,s,i)=>{i.r(s),i.d(s,{default:()=>l});var n=i(43),a=i(584),t=i(579);const l=()=>{const[e,s]=(0,n.useState)(!0),[i,l]=(0,n.useState)(!1),[c,r]=(0,n.useState)(null),[o,d]=(0,n.useState)(null),[m,h]=(0,n.useState)("general"),[u,g]=(0,n.useState)({maintenance_mode:!1,enforce_2fa:!1,minimum_password_length:8,session_timeout_minutes:60,allow_social_login:!0,max_login_attempts:5,smtp_config:{host:"",port:587,username:"",password:"",from_email:"",secure:!0},ui_config:{primary_color:"#FFD700",secondary_color:"#FF6347",logo_url:"/logo.svg",favicon_url:"/favicon.ico",allow_theme_selection:!0}});(0,n.useEffect)((()=>{p()}),[]);const p=async()=>{try{s(!0);const{data:{user:e}}=await a.N.auth.getUser();if(!e)throw new Error("User not authenticated");const{data:i}=await a.N.from("profiles").select("role").eq("id",e.id).single();if(!i||"admin"!==i.role)throw new Error("You do not have admin access");setTimeout((()=>{s(!1)}),1e3)}catch(e){console.error("Error fetching settings:",e),r(e.message||"Failed to load settings"),s(!1)}},x=(e,s,i)=>{g("smtp_config"===e||"ui_config"===e?n=>({...n,[e]:{...n[e],[s]:i}}):e=>({...e,[s]:i}))};return e?(0,t.jsxs)("div",{className:"loading-container",children:[(0,t.jsx)("div",{className:"loading-spinner"}),(0,t.jsx)("p",{children:"Loading settings..."})]}):(0,t.jsxs)("div",{className:"admin-settings-container",children:[(0,t.jsx)("div",{className:"admin-settings-header",children:(0,t.jsx)("h1",{children:"Admin Settings"})}),c&&(0,t.jsxs)("div",{className:"error-alert",children:[(0,t.jsx)("i",{className:"icon-warning"}),(0,t.jsx)("p",{children:c}),(0,t.jsx)("button",{className:"error-close",onClick:()=>r(null),children:"\xd7"})]}),o&&(0,t.jsxs)("div",{className:"success-alert",children:[(0,t.jsx)("i",{className:"icon-check-circle"}),(0,t.jsx)("p",{children:o}),(0,t.jsx)("button",{className:"success-close",onClick:()=>d(null),children:"\xd7"})]}),(0,t.jsxs)("div",{className:"settings-content",children:[(0,t.jsxs)("div",{className:"settings-tabs",children:[(0,t.jsx)("button",{className:"settings-tab "+("general"===m?"active":""),onClick:()=>h("general"),children:"General"}),(0,t.jsx)("button",{className:"settings-tab "+("security"===m?"active":""),onClick:()=>h("security"),children:"Security"}),(0,t.jsx)("button",{className:"settings-tab "+("smtp"===m?"active":""),onClick:()=>h("smtp"),children:"Email (SMTP)"}),(0,t.jsx)("button",{className:"settings-tab "+("ui"===m?"active":""),onClick:()=>h("ui"),children:"UI Customization"})]}),(0,t.jsxs)("div",{className:"settings-panel",children:["general"===m&&(0,t.jsxs)("div",{className:"settings-section",children:[(0,t.jsx)("h2",{children:"General Settings"}),(0,t.jsxs)("div",{className:"settings-group",children:[(0,t.jsxs)("div",{className:"setting-item",children:[(0,t.jsxs)("div",{className:"setting-info",children:[(0,t.jsx)("div",{className:"setting-name",children:"Maintenance Mode"}),(0,t.jsx)("div",{className:"setting-description",children:"Put the application in maintenance mode. Only admins will be able to access the system."})]}),u.maintenance_mode?(0,t.jsx)("button",{className:"btn btn-outline btn-warning",onClick:async()=>{try{l(!0),r(null),g((e=>({...e,maintenance_mode:!1}))),setTimeout((()=>{d("Maintenance mode disabled. All users can now access the application."),l(!1)}),1e3)}catch(e){console.error("Error disabling maintenance mode:",e),r(e.message||"Failed to disable maintenance mode"),l(!1)}},disabled:i,children:"Exit Maintenance Mode"}):(0,t.jsx)("button",{className:"btn btn-outline btn-danger",onClick:async()=>{try{l(!0),r(null),g((e=>({...e,maintenance_mode:!0}))),setTimeout((()=>{d("Maintenance mode enabled. All non-admin users will be redirected to maintenance page."),l(!1)}),1e3)}catch(e){console.error("Error enabling maintenance mode:",e),r(e.message||"Failed to enable maintenance mode"),l(!1)}},disabled:i,children:"Enter Maintenance Mode"})]}),(0,t.jsxs)("div",{className:"setting-item",children:[(0,t.jsxs)("div",{className:"setting-info",children:[(0,t.jsx)("div",{className:"setting-name",children:"System Status"}),(0,t.jsx)("div",{className:"setting-description",children:"Current system operational status"})]}),(0,t.jsx)("div",{className:"status-indicator healthy",children:"Operational"})]}),(0,t.jsxs)("div",{className:"setting-item",children:[(0,t.jsxs)("div",{className:"setting-info",children:[(0,t.jsx)("div",{className:"setting-name",children:"Allow Social Login"}),(0,t.jsx)("div",{className:"setting-description",children:"Enable users to log in with social accounts"})]}),(0,t.jsxs)("label",{className:"switch",children:[(0,t.jsx)("input",{type:"checkbox",checked:u.allow_social_login,onChange:e=>x("","allow_social_login",e.target.checked)}),(0,t.jsx)("span",{className:"slider"})]})]}),(0,t.jsxs)("div",{className:"setting-item",children:[(0,t.jsxs)("div",{className:"setting-info",children:[(0,t.jsx)("div",{className:"setting-name",children:"Session Timeout"}),(0,t.jsx)("div",{className:"setting-description",children:"Time in minutes until user sessions expire"})]}),(0,t.jsxs)("div",{className:"number-input",children:[(0,t.jsx)("input",{type:"number",value:u.session_timeout_minutes,onChange:e=>x("","session_timeout_minutes",parseInt(e.target.value)),min:"15",max:"1440"}),(0,t.jsx)("span",{children:"minutes"})]})]})]})]}),"security"===m&&(0,t.jsxs)("div",{className:"settings-section",children:[(0,t.jsx)("h2",{children:"Security Settings"}),(0,t.jsxs)("div",{className:"settings-group",children:[(0,t.jsxs)("div",{className:"setting-item",children:[(0,t.jsxs)("div",{className:"setting-info",children:[(0,t.jsx)("div",{className:"setting-name",children:"Enforce Two-Factor Authentication"}),(0,t.jsx)("div",{className:"setting-description",children:"Require all users to set up 2FA"})]}),(0,t.jsxs)("label",{className:"switch",children:[(0,t.jsx)("input",{type:"checkbox",checked:u.enforce_2fa,onChange:e=>x("","enforce_2fa",e.target.checked)}),(0,t.jsx)("span",{className:"slider"})]})]}),(0,t.jsxs)("div",{className:"setting-item",children:[(0,t.jsxs)("div",{className:"setting-info",children:[(0,t.jsx)("div",{className:"setting-name",children:"Minimum Password Length"}),(0,t.jsx)("div",{className:"setting-description",children:"Minimum number of characters for passwords"})]}),(0,t.jsxs)("div",{className:"number-input",children:[(0,t.jsx)("input",{type:"number",value:u.minimum_password_length,onChange:e=>x("","minimum_password_length",parseInt(e.target.value)),min:"6",max:"20"}),(0,t.jsx)("span",{children:"characters"})]})]}),(0,t.jsxs)("div",{className:"setting-item",children:[(0,t.jsxs)("div",{className:"setting-info",children:[(0,t.jsx)("div",{className:"setting-name",children:"Maximum Login Attempts"}),(0,t.jsx)("div",{className:"setting-description",children:"Number of failed logins before account is locked"})]}),(0,t.jsxs)("div",{className:"number-input",children:[(0,t.jsx)("input",{type:"number",value:u.max_login_attempts,onChange:e=>x("","max_login_attempts",parseInt(e.target.value)),min:"3",max:"10"}),(0,t.jsx)("span",{children:"attempts"})]})]})]})]}),"smtp"===m&&(0,t.jsxs)("div",{className:"settings-section",children:[(0,t.jsx)("h2",{children:"Email Configuration (SMTP)"}),(0,t.jsxs)("div",{className:"settings-group",children:[(0,t.jsxs)("div",{className:"form-row",children:[(0,t.jsxs)("div",{className:"form-group",children:[(0,t.jsx)("label",{htmlFor:"smtp-host",children:"SMTP Host"}),(0,t.jsx)("input",{id:"smtp-host",type:"text",value:u.smtp_config.host,onChange:e=>x("smtp_config","host",e.target.value),placeholder:"e.g. smtp.gmail.com"})]}),(0,t.jsxs)("div",{className:"form-group",children:[(0,t.jsx)("label",{htmlFor:"smtp-port",children:"SMTP Port"}),(0,t.jsx)("input",{id:"smtp-port",type:"number",value:u.smtp_config.port,onChange:e=>x("smtp_config","port",parseInt(e.target.value)),placeholder:"e.g. 587"})]})]}),(0,t.jsxs)("div",{className:"form-row",children:[(0,t.jsxs)("div",{className:"form-group",children:[(0,t.jsx)("label",{htmlFor:"smtp-user",children:"SMTP Username"}),(0,t.jsx)("input",{id:"smtp-user",type:"text",value:u.smtp_config.username,onChange:e=>x("smtp_config","username",e.target.value),placeholder:"e.g. your@email.com"})]}),(0,t.jsxs)("div",{className:"form-group",children:[(0,t.jsx)("label",{htmlFor:"smtp-pass",children:"SMTP Password"}),(0,t.jsx)("input",{id:"smtp-pass",type:"password",value:u.smtp_config.password,onChange:e=>x("smtp_config","password",e.target.value),placeholder:"\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022"})]})]}),(0,t.jsxs)("div",{className:"form-group",children:[(0,t.jsx)("label",{htmlFor:"from-email",children:"From Email"}),(0,t.jsx)("input",{id:"from-email",type:"email",value:u.smtp_config.from_email,onChange:e=>x("smtp_config","from_email",e.target.value),placeholder:"e.g. noreply@petfeeder.com"})]}),(0,t.jsxs)("div",{className:"setting-item",children:[(0,t.jsxs)("div",{className:"setting-info",children:[(0,t.jsx)("div",{className:"setting-name",children:"Use Secure Connection (TLS/SSL)"}),(0,t.jsx)("div",{className:"setting-description",children:"Enable secure connection for SMTP"})]}),(0,t.jsxs)("label",{className:"switch",children:[(0,t.jsx)("input",{type:"checkbox",checked:u.smtp_config.secure,onChange:e=>x("smtp_config","secure",e.target.checked)}),(0,t.jsx)("span",{className:"slider"})]})]}),(0,t.jsx)("div",{className:"form-actions",children:(0,t.jsx)("button",{className:"btn btn-outline",onClick:async()=>{try{l(!0),r(null),setTimeout((()=>{d("SMTP connection successful! Test email sent to admin."),l(!1)}),1500)}catch(e){console.error("Error testing SMTP connection:",e),r(e.message||"Failed to test SMTP connection"),l(!1)}},disabled:i||!u.smtp_config.host||!u.smtp_config.username,children:"Test Connection"})})]})]}),"ui"===m&&(0,t.jsxs)("div",{className:"settings-section",children:[(0,t.jsx)("h2",{children:"UI Customization"}),(0,t.jsxs)("div",{className:"settings-group",children:[(0,t.jsx)("h3",{children:"Theme Colors"}),(0,t.jsxs)("div",{className:"form-row",children:[(0,t.jsxs)("div",{className:"form-group",children:[(0,t.jsx)("label",{htmlFor:"primary-color",children:"Primary Color"}),(0,t.jsxs)("div",{className:"color-input",children:[(0,t.jsx)("input",{id:"primary-color",type:"color",value:u.ui_config.primary_color,onChange:e=>x("ui_config","primary_color",e.target.value)}),(0,t.jsx)("input",{type:"text",value:u.ui_config.primary_color,onChange:e=>x("ui_config","primary_color",e.target.value),placeholder:"#FFD700"})]})]}),(0,t.jsxs)("div",{className:"form-group",children:[(0,t.jsx)("label",{htmlFor:"secondary-color",children:"Secondary Color"}),(0,t.jsxs)("div",{className:"color-input",children:[(0,t.jsx)("input",{id:"secondary-color",type:"color",value:u.ui_config.secondary_color,onChange:e=>x("ui_config","secondary_color",e.target.value)}),(0,t.jsx)("input",{type:"text",value:u.ui_config.secondary_color,onChange:e=>x("ui_config","secondary_color",e.target.value),placeholder:"#FF6347"})]})]})]}),(0,t.jsxs)("div",{className:"color-preview",children:[(0,t.jsx)("div",{className:"preview-title",children:"Color Preview"}),(0,t.jsxs)("div",{className:"preview-colors",children:[(0,t.jsx)("div",{className:"preview-primary",style:{backgroundColor:u.ui_config.primary_color},children:"Primary"}),(0,t.jsx)("div",{className:"preview-secondary",style:{backgroundColor:u.ui_config.secondary_color},children:"Secondary"})]})]})]}),(0,t.jsxs)("div",{className:"settings-group",children:[(0,t.jsx)("h3",{children:"Logo & Favicon"}),(0,t.jsxs)("div",{className:"form-group",children:[(0,t.jsx)("label",{htmlFor:"logo-url",children:"Logo URL"}),(0,t.jsx)("input",{id:"logo-url",type:"text",value:u.ui_config.logo_url,onChange:e=>x("ui_config","logo_url",e.target.value),placeholder:"/logo.svg"})]}),(0,t.jsxs)("div",{className:"form-group",children:[(0,t.jsx)("label",{htmlFor:"favicon-url",children:"Favicon URL"}),(0,t.jsx)("input",{id:"favicon-url",type:"text",value:u.ui_config.favicon_url,onChange:e=>x("ui_config","favicon_url",e.target.value),placeholder:"/favicon.ico"})]}),(0,t.jsxs)("div",{className:"setting-item",children:[(0,t.jsxs)("div",{className:"setting-info",children:[(0,t.jsx)("div",{className:"setting-name",children:"Allow User Theme Selection"}),(0,t.jsx)("div",{className:"setting-description",children:"Let users select light/dark theme"})]}),(0,t.jsxs)("label",{className:"switch",children:[(0,t.jsx)("input",{type:"checkbox",checked:u.ui_config.allow_theme_selection,onChange:e=>x("ui_config","allow_theme_selection",e.target.checked)}),(0,t.jsx)("span",{className:"slider"})]})]})]})]}),(0,t.jsx)("div",{className:"settings-actions",children:(0,t.jsx)("button",{className:"btn btn-primary btn-save",onClick:async()=>{try{l(!0),r(null),setTimeout((()=>{d("Settings saved successfully"),l(!1)}),1e3)}catch(e){console.error("Error saving settings:",e),r(e.message||"Failed to save settings"),l(!1)}},disabled:i,children:i?"Saving...":"Save Settings"})})]})]})]})}}}]);
//# sourceMappingURL=214.adad252f.chunk.js.map
{"ast":null,"code":"import React,{useState,useEffect}from'react';import{supabase}from'../supabaseClient.ts';import'../styles/History.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const History=()=>{const[history,setHistory]=useState([]);const[searchTerm,setSearchTerm]=useState('');const[currentPage,setCurrentPage]=useState(1);const[itemsPerPage]=useState(10);useEffect(()=>{const fetchHistory=async()=>{const{data,error}=await supabase.from('feeding_history').select('*').order('time',{ascending:false});if(error){console.error('Error fetching history:',error);}else{setHistory(data||[]);}};fetchHistory();},[]);const filteredHistory=history.filter(item=>item.device_id.toLowerCase().includes(searchTerm.toLowerCase()));const paginatedHistory=filteredHistory.slice((currentPage-1)*itemsPerPage,currentPage*itemsPerPage);const totalPages=Math.ceil(filteredHistory.length/itemsPerPage);const handlePageChange=page=>{setCurrentPage(page);};return/*#__PURE__*/_jsxs(\"div\",{className:\"history-container\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"Feeding History\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Search by device ID\",value:searchTerm,onChange:e=>setSearchTerm(e.target.value),className:\"search-bar\"}),/*#__PURE__*/_jsxs(\"table\",{className:\"history-table\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:\"Device ID\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Time\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Amount (g)\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:paginatedHistory.map((item,index)=>/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:item.device_id}),/*#__PURE__*/_jsx(\"td\",{children:new Date(item.time).toLocaleString()}),/*#__PURE__*/_jsx(\"td\",{children:item.amount})]},index))})]}),/*#__PURE__*/_jsx(\"div\",{className:\"pagination\",children:Array.from({length:totalPages},(_,i)=>i+1).map(page=>/*#__PURE__*/_jsx(\"button\",{onClick:()=>handlePageChange(page),className:page===currentPage?'active':'',children:page},page))})]});};export default History;","map":{"version":3,"names":["React","useState","useEffect","supabase","jsx","_jsx","jsxs","_jsxs","History","history","setHistory","searchTerm","setSearchTerm","currentPage","setCurrentPage","itemsPerPage","fetchHistory","data","error","from","select","order","ascending","console","filteredHistory","filter","item","device_id","toLowerCase","includes","paginatedHistory","slice","totalPages","Math","ceil","length","handlePageChange","page","className","children","type","placeholder","value","onChange","e","target","map","index","Date","time","toLocaleString","amount","Array","_","i","onClick"],"sources":["/workspaces/Smart_Pet_Feeder/src/pages/History.tsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { supabase } from '../supabaseClient.ts';\nimport '../styles/History.css';\n\nconst History: React.FC = () => {\n  const [history, setHistory] = useState<any[]>([]);\n  const [searchTerm, setSearchTerm] = useState('');\n  const [currentPage, setCurrentPage] = useState(1);\n  const [itemsPerPage] = useState(10);\n\n  useEffect(() => {\n    const fetchHistory = async () => {\n      const { data, error } = await supabase\n        .from('feeding_history')\n        .select('*')\n        .order('time', { ascending: false });\n\n      if (error) {\n        console.error('Error fetching history:', error);\n      } else {\n        setHistory(data || []);\n      }\n    };\n\n    fetchHistory();\n  }, []);\n\n  const filteredHistory = history.filter(item =>\n    item.device_id.toLowerCase().includes(searchTerm.toLowerCase())\n  );\n\n  const paginatedHistory = filteredHistory.slice(\n    (currentPage - 1) * itemsPerPage,\n    currentPage * itemsPerPage\n  );\n\n  const totalPages = Math.ceil(filteredHistory.length / itemsPerPage);\n\n  const handlePageChange = (page: number) => {\n    setCurrentPage(page);\n  };\n\n  return (\n    <div className=\"history-container\">\n      <h1>Feeding History</h1>\n      <input\n        type=\"text\"\n        placeholder=\"Search by device ID\"\n        value={searchTerm}\n        onChange={(e) => setSearchTerm(e.target.value)}\n        className=\"search-bar\"\n      />\n\n      <table className=\"history-table\">\n        <thead>\n          <tr>\n            <th>Device ID</th>\n            <th>Time</th>\n            <th>Amount (g)</th>\n          </tr>\n        </thead>\n        <tbody>\n          {paginatedHistory.map((item, index) => (\n            <tr key={index}>\n              <td>{item.device_id}</td>\n              <td>{new Date(item.time).toLocaleString()}</td>\n              <td>{item.amount}</td>\n            </tr>\n          ))}\n        </tbody>\n      </table>\n\n      <div className=\"pagination\">\n        {Array.from({ length: totalPages }, (_, i) => i + 1).map(page => (\n          <button\n            key={page}\n            onClick={() => handlePageChange(page)}\n            className={page === currentPage ? 'active' : ''}\n          >\n            {page}\n          </button>\n        ))}\n      </div>\n    </div>\n  );\n};\n\nexport default History;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}
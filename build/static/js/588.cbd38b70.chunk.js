"use strict";(self.webpackChunksmart_pet_feeder=self.webpackChunksmart_pet_feeder||[]).push([[588],{588:(e,s,t)=>{t.r(s),t.d(s,{default:()=>i});var a=t(43),d=t(584),l=t(579);const i=()=>{const[e,s]=(0,a.useState)([]),[t,i]=(0,a.useState)({time:"",amount:0,device_id:""}),[r,n]=(0,a.useState)(!1),[c,o]=(0,a.useState)(!0),[u,h]=(0,a.useState)(null);(0,a.useEffect)((()=>{(async()=>{try{const{data:{user:e},error:t}=await d.N.auth.getUser();if(t)throw t;if(!e)return o(!1),void h("You need to be logged in to view schedules");const{data:a,error:l}=await d.N.from("schedules").select("*").eq("user_id",e.id);if(l)throw l;s(a||[])}catch(e){console.error("Error fetching schedules:",e),h(e.message||"Failed to load schedules")}finally{o(!1)}})()}),[]);return(0,l.jsxs)("div",{className:"schedule-page",children:[(0,l.jsx)("h1",{children:"Feeding Schedules"}),u&&(0,l.jsxs)("div",{className:"error-alert",children:[(0,l.jsx)("p",{children:u}),(0,l.jsx)("button",{onClick:()=>h(null),children:"\xd7"})]}),c?(0,l.jsxs)("div",{className:"loading-container",children:[(0,l.jsx)("div",{className:"loading-spinner"}),(0,l.jsx)("p",{children:"Loading schedules..."})]}):(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("button",{className:"btn btn-primary",onClick:()=>n(!0),children:"Add Schedule"}),e.length>0?(0,l.jsx)("ul",{className:"schedule-list",children:e.map((e=>(0,l.jsx)("li",{className:"schedule-item",children:(0,l.jsxs)("div",{className:"schedule-info",children:[(0,l.jsxs)("p",{children:["Time: ",new Date(e.time).toLocaleString()]}),(0,l.jsxs)("p",{children:["Amount: ",e.amount,"g"]}),(0,l.jsxs)("p",{children:["Device ID: ",e.device_id]})]})},e.schedule_id)))}):(0,l.jsx)("div",{className:"empty-state",children:(0,l.jsx)("p",{children:"No schedules found. Add your first feeding schedule!"})})]}),r&&(0,l.jsx)("div",{className:"modal",children:(0,l.jsxs)("div",{className:"modal-content",children:[(0,l.jsx)("div",{className:"modal-header",children:(0,l.jsx)("h2",{children:"Add Schedule"})}),(0,l.jsxs)("form",{onSubmit:async a=>{a.preventDefault();try{const{data:{user:a},error:l}=await d.N.auth.getUser();if(l)throw l;if(!a)return void h("You need to be logged in to create schedules");const{data:r,error:c}=await d.N.from("schedules").insert([{...t,user_id:a.id}]).select();if(c)throw c;r&&r.length>0&&(s([...e,r[0]]),n(!1),i({time:"",amount:0,device_id:""}))}catch(l){console.error("Error adding schedule:",l),h(l.message||"Failed to create schedule")}},children:[(0,l.jsxs)("div",{className:"modal-body",children:[(0,l.jsxs)("label",{children:["Time:",(0,l.jsx)("input",{type:"datetime-local",value:t.time,onChange:e=>i({...t,time:e.target.value}),required:!0})]}),(0,l.jsxs)("label",{children:["Amount (grams):",(0,l.jsx)("input",{type:"number",value:t.amount,onChange:e=>i({...t,amount:parseInt(e.target.value)}),min:"1",required:!0})]}),(0,l.jsxs)("label",{children:["Device ID:",(0,l.jsx)("input",{type:"text",value:t.device_id,onChange:e=>i({...t,device_id:e.target.value}),required:!0})]})]}),(0,l.jsxs)("div",{className:"modal-footer",children:[(0,l.jsx)("button",{type:"button",className:"btn btn-outline",onClick:()=>n(!1),children:"Cancel"}),(0,l.jsx)("button",{className:"btn btn-primary",type:"submit",children:"Add Schedule"})]})]})]})})]})}}}]);
//# sourceMappingURL=588.cbd38b70.chunk.js.map